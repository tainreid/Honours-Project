<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Honours Project – Emotional Responses</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #cceeff;
      padding: 30px;
      margin: 0;
    }

    .content-box {
      background: #ffffff;
      padding: 30px;
      border-radius: 10px;
      max-width: 900px;
      margin: 0 auto;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .hidden {
      display: none;
    }

    .slider-group {
      margin: 15px auto;
      text-align: center;
    }

    label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }

    input[type=range],
    input[type=text],
    select,
    textarea {
      width: 60%;
      padding: 6px;
      margin: 10px auto;
      display: block;
      font-size: 16px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
      cursor: pointer;
    }

    .question {
      margin: 15px auto;
      max-width: 700px;
      text-align: center;
    }

    .consent-paragraph {
      margin: 10px auto;
      max-width: 700px;
      text-align: center;
    }

    .video-wrapper iframe {
      width: 80%;
      height: 450px;
      max-width: 800px;
      border: none;
      margin: 20px auto;
      display: block;
    }

    .consent-check {
      margin-top: 20px;
    }

    #ageWarning {
      color: red;
      font-weight: bold;
      display: none;
    }
  </style>
</head>
<body>
  <div class="content-box">

    <!-- CONSENT PAGE -->
    <div id="intro">
      <h1>Honours Project</h1>
      <h2>Reimagining Classic Animation: Portraying Emotion Through Modern Sound Design Techniques</h2>
      <p class="consent-paragraph">
        This study explores how modern sound design can enhance emotional engagement in classic animations by comparing emotional responses to the original and redesigned soundtracks.
      </p>

      <h3>Participant Consent and Ethical Approval</h3>
      <div class="consent-paragraph">
        <p>1. I freely and voluntarily consent to be a participant in the research project on the topic of emotional responses to sound design in classic animation, to be conducted by Tain Reid, who is an undergraduate student at Edinburgh Napier University.</p>
        <p>2. The broad goal of this research study is to explore how updated sound design affects emotional engagement. Specifically, I have been asked to watch two animation clips and move sliders to show how I feel during each, which should take no longer than 10–15 minutes to complete.</p>
        <p>3. I have been told that my responses will be anonymised. My name will not be linked with the research materials, and I will not be identified or identifiable in any report subsequently produced by the researcher.</p>
        <p>4. I also understand that if at any time during the session I feel unable or unwilling to continue, I am free to leave.</p>
        <p>5. In addition, should I not wish to answer any particular question or questions, I am free to decline.</p>
        <p>6. I have been given the opportunity to ask questions regarding the procedure and my questions have been answered to my satisfaction.</p>
        <p>7. I have read and understand the above and consent to participate in this study.</p>
      </div>

      <div class="consent-check">
        <label><input type="checkbox" id="consentYes" /> Yes</label>
        <label><input type="checkbox" id="consentNo" /> No</label>
        <br />
        <button id="consentNextBtn" class="hidden" onclick="startDemographics()">Next Page</button>
      </div>
    </div>

    <!-- DEMOGRAPHICS -->
    <div id="demographicPage" class="hidden">
      <h2>Demographic Questions</h2>

      <div class="question">
        <label for="age">What is your age?</label>
        <select id="age">
          <option value="">-- Select --</option>
          <option value="Under 18">Under 18</option>
          <option value="18-24">18-24</option>
          <option value="25-34">25-34</option>
          <option value="35-44">35-44</option>
          <option value="45-54">45-54</option>
          <option value="55-64">55-64</option>
          <option value="65 and over">65 and over</option>
        </select>
      </div>

      <div class="question">
        <label for="gender">What is your gender?</label>
        <input type="text" id="gender" />
      </div>

      <div class="question">
        <label for="hearing">Do you believe yourself to have efficient hearing for your age?</label>
        <select id="hearing">
          <option value="">-- Select --</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
      </div>

      <div class="question">
        <label for="watching">How often do you watch animated films or shows?</label>
        <select id="watching">
          <option value="">-- Select --</option>
          <option value="Very Often">Very Often</option>
          <option value="Often">Often</option>
          <option value="Sometimes">Sometimes</option>
          <option value="Rarely">Rarely</option>
          <option value="Never">Never</option>
        </select>
      </div>

      <div id="ageWarning">Sorry, you must be 18 or older to take part in this study.</div>

      <button onclick="startOriginal()">Begin Study</button>
    </div>

    <!-- ORIGINAL VIDEO -->
    <div id="video1Page" class="hidden">
      <h3>Watch the Original Animation Clip</h3>
      <p>Adjust the sliders whenever you believe each type of emotion is shown during the clip.</p>
      <div class="video-wrapper">
        <iframe id="video1" src="https://www.youtube.com/embed/nLUffCy9AQE?enablejsapi=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>
      <div id="sliders1"></div>
      <button onclick="endVideo1()">Next</button>
    </div>

    <!-- QUESTIONS AFTER ORIGINAL -->
    <div id="questions1" class="hidden">
      <h3>Quick Questions – Original Clip</h3>
      <div class="question">
        <label>1. What emotions did you feel the strongest while watching this clip?</label>
        <textarea id="q1a"></textarea>
      </div>
      <div class="question">
        <label>2. How did the sound contribute to the emotions you felt?</label>
        <textarea id="q1b"></textarea>
      </div>
	  <div class="question">
        <label>3. Were there any sounds that stood out to you?</label>
        <textarea id="q1b"></textarea>
      </div>
	  <div class="question">
        <label>4. How well do you think the sound matched the visuals?</label>
        <textarea id="q1b"></textarea>
      </div>
	  <div class="question">
        <label>5. How would you describe your overall emotional reaction to the video?</label>
        <textarea id="q1b"></textarea>
      </div>
      <button onclick="startReimagined()">Next</button>
    </div>







    <!-- REIMAGINED VIDEO -->
    <div id="video2Page" class="hidden">
      <h3>Watch the Reimagined Clip with New Sound Design</h3>
      <p>Adjust the sliders whenever you feel an emotion during the clip.</p>
      <div class="video-wrapper">
        <iframe id="video2" src="https://www.youtube.com/embed/1Dm-rOhLWDc?enablejsapi=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>
      <div id="sliders2"></div>
      <button onclick="endVideo2()">Next</button>
    </div>

    <!-- QUESTIONS AFTER REIMAGINED -->
    <div id="questions2" class="hidden">
      <h3>Quick Questions – Reimagined Clip</h3>
      <div class="question">
        <label>1. What emotions did you feel the strongest while watching this clip?</label>
        <textarea id="q1a"></textarea>
      </div>
      <div class="question">
        <label>2. How did the sound contribute to the emotions you felt?</label>
        <textarea id="q1b"></textarea>
      </div>
	  <div class="question">
        <label>3. Were there any sounds that stood out to you?</label>
        <textarea id="q1b"></textarea>
      </div>
	  <div class="question">
        <label>4. How well do you think the sound matched the visuals?</label>
        <textarea id="q1b"></textarea>
      </div>
	  <div class="question">
        <label>5. How would you describe your overall emotional reaction to the video?</label>
        <textarea id="q1b"></textarea>
      </div>
      <button onclick="showOverallPage()">Next</button>
    </div>

    <!-- OVERALL COMPARISON PAGE -->
    <div id="overallPage" class="hidden">
      <h3>Overall Comparison</h3>
      <div class="question">
        <label>Which video’s sound did you prefer?</label>
        <select id="soundPreference">
          <option value="">-- Select --</option>
          <option value="Video 1">Video 1 (Original)</option>
          <option value="Video 2">Video 2 (Reimagined)</option>
        </select>
      </div>

      <div class="question">
        <label>Which video was more effective in conveying emotions?</label>
        <select id="emotionEffectiveness">
          <option value="">-- Select --</option>
          <option value="Video 1">Video 1 (Original)</option>
          <option value="Video 2">Video 2 (Reimagined)</option>
        </select>
      </div>

      <button onclick="finishStudy()">Finish</button>
    </div>

    <!-- THANK YOU -->
    <div id="thanks" class="hidden">
      <h2>Thank you for taking part!</h2>
      <p>Your feedback has been recorded.</p>
    </div>
  </div>

<script>
  const emotions = ["Anger", "Surprise", "Disgust", "Enjoyment", "Fear", "Sadness"];
  let emotionDataV1 = [];
  let emotionDataV2 = [];
  let sliderTimer;

  function createSliders(container, groupId) {
    container.innerHTML = '';
    emotions.forEach(emotion => {
      const group = document.createElement("div");
      group.className = "slider-group";
      group.innerHTML = `
        <label>${emotion}</label>
        <input type="range" min="0" max="5" value="0" id="${groupId}-${emotion}">
      `;
      container.appendChild(group);
    });
  }

  function trackSliders(groupId, dataArray) {
    const start = Date.now();
    sliderTimer = setInterval(() => {
      const time = ((Date.now() - start) / 1000).toFixed(1);
      const row = { time };
      emotions.forEach(emotion => {
        const el = document.getElementById(`${groupId}-${emotion}`);
        if (el) row[emotion] = el.value;
      });
      dataArray.push(row);
    }, 1000);
  }

  function stopTracking() {
    clearInterval(sliderTimer);
  }

  function stopYouTube(iframeId) {
    const iframe = document.getElementById(iframeId);
    iframe.contentWindow.postMessage('{"event":"command","func":"stopVideo","args":""}', '*');
  }

  document.getElementById("consentYes").addEventListener("change", () => {
    document.getElementById("consentNo").checked = false;
    document.getElementById("consentNextBtn").classList.toggle("hidden", !document.getElementById("consentYes").checked);
  });

  document.getElementById("consentNo").addEventListener("change", () => {
    document.getElementById("consentYes").checked = false;
    document.getElementById("consentNextBtn").classList.add("hidden");
  });

  function startDemographics() {
    document.getElementById("intro").classList.add("hidden");
    document.getElementById("demographicPage").classList.remove("hidden");
  }

  function startOriginal() {
    const age = document.getElementById("age").value;
    if (age === "Under 18") {
      document.getElementById("ageWarning").style.display = "block";
      return;
    }

    document.getElementById("ageWarning").style.display = "none";
    document.getElementById("demographicPage").classList.add("hidden");
    document.getElementById("video1Page").classList.remove("hidden");
    createSliders(document.getElementById("sliders1"), "v1");
    trackSliders("v1", emotionDataV1);
  }

  function endVideo1() {
    stopTracking();
    stopYouTube("video1");
    document.getElementById("video1Page").classList.add("hidden");
    document.getElementById("questions1").classList.remove("hidden");
  }

  function startReimagined() {
    document.getElementById("questions1").classList.add("hidden");
    document.getElementById("video2Page").classList.remove("hidden");
    createSliders(document.getElementById("sliders2"), "v2");
    trackSliders("v2", emotionDataV2);
  }

  function endVideo2() {
    stopTracking();
    stopYouTube("video2");
    document.getElementById("video2Page").classList.add("hidden");
    document.getElementById("questions2").classList.remove("hidden");
  }

  function showOverallPage() {
    document.getElementById("questions2").classList.add("hidden");
    document.getElementById("overallPage").classList.remove("hidden");
  }

  function finishStudy() {
    const metadata = collectFormResponses();
    submitToGoogleSheet(metadata, emotionDataV1, emotionDataV2);

    document.getElementById("overallPage").classList.add("hidden");
    document.getElementById("thanks").classList.remove("hidden");
  }

  function collectFormResponses() {
    return {
      Age: document.getElementById("age").value,
      Gender: document.getElementById("gender").value,
      Hearing: document.getElementById("hearing").value,
      Watching: document.getElementById("watching").value,

      Q1: document.getElementById("q1a").value,
      Q2: document.querySelectorAll("#questions1 textarea")[1]?.value || "",
      Q3: document.querySelectorAll("#questions1 textarea")[2]?.value || "",
      Q4: document.querySelectorAll("#questions1 textarea")[3]?.value || "",
      Q5: document.querySelectorAll("#questions1 textarea")[4]?.value || "",

      Q6: document.querySelector("#questions2 textarea:nth-of-type(1)")?.value || "",
      Q7: document.querySelector("#questions2 textarea:nth-of-type(2)")?.value || "",
      Q8: document.querySelector("#questions2 textarea:nth-of-type(3)")?.value || "",
      Q9: document.querySelector("#questions2 textarea:nth-of-type(4)")?.value || "",
      Q10: document.querySelector("#questions2 textarea:nth-of-type(5)")?.value || "",

      SoundPreference: document.getElementById("soundPreference").value,
      EmotionEffectiveness: document.getElementById("emotionEffectiveness").value
    };
  }

function submitToGoogleSheet(metadata, video1Data, video2Data) {
  fetch("https://script.google.com/macros/s/AKfycbywaMNDnQKVMLIl-V_oP_dMO6O2HWN4iT39N7ku_0eu7LFeUAchZQ-xyLi78KP6QJNH/exec", {
    method: "POST",
    body: JSON.stringify({
      metadata,
      video1: video1Data,
      video2: video2Data
    }),
    headers: {
      "Content-Type": "application/json"
    }
  })
  .then(res => res.text())
  .then(msg => console.log("✅ Data submitted:", msg))
  .catch(err => console.error("❌ Submission failed:", err));
}
</script>

</body>
</html>
